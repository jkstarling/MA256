---
title: ''
geometry: "left=2cm,right=2cm,top=1cm,bottom=2cm"
output:
  pdf_document:
    extra_dependencies: ["xcolor", "amsmath","multicol"]
  html_document: default
editor_options:
  markdown:
    wrap: 100
---

\newcommand{\sol}[1]{\color{violet} #1 \color{black}}
<!-- xcolor standard colors: 
black, blue, brown, cyan, darkgray, green, lime, magenta, olive, orange, red, purple, teal, violet, yellow, etc.  -->


## Lesson 19: ACFT Problem (solution)
```{r setup, message=FALSE, echo=TRUE, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,   # avoid warnings and messages in the output
  message = FALSE,  # collapse all output into a single block
  tidy = FALSE,      # don't tidy our code-- assume we do it ourselves
  out.width = "50%"
)
```



```{r  include=FALSE}
rm(list=ls())
library(tidyverse)
library(janitor)
# theme_set(theme_bw())
```

```{r, include=FALSE}
df <-  read_csv("https://raw.githubusercontent.com/acammack1234/ma206/main/acft_ioct.csv")
```

### Is there an association between the Standing Power Throw and Maximum Deadlift raw scores?

We are going to determine if an association exists between `spr_raw` and `mdl_raw` scores.

The relationship we are modeling looks like this:

$$\widehat{mdl} = \beta_0 + \beta_1 \cdot spr$$

1.  Provide the hypotheses in symbols and words:

\sol{$H_0: \beta_1 = 0$. My null hypothesis is that there is no association between `spr\_raw` and `mdl\_raw`\\
$H_A: \beta_1 \neq 0$. My null hypothesis is that there is an association between `spr\_raw` and `mdl\_raw`.}

2.  Plot the association, including the regression line.

```{r}
df %>%
  ggplot(aes(x = spr_raw, y = mdl_raw)) +
  geom_point() +
  geom_smooth(method = "lm")
```

3.  Is there anything unusual about the data?

\sol{Yes. Outlier.}

4.  Remove the outlier using the `filter( )` command. How many observations were dropped?

```{r}
df <- df %>% filter(spr_raw < 100)  
```

5.  Create a new scatter plot with updated dataframe.

```{r}
df %>%
  ggplot(aes(x = spr_raw, y = mdl_raw)) +
  geom_point() +
  geom_smooth(method = "lm")
```

6.  Create a linear model to test your hypotheses.

```{r}
lrmodel <- df %>%
  lm(mdl_raw ~ spr_raw, data = .)
summary(lrmodel)
```

7.  Write out the linear model with the coefficients determined by the linear regression. 

\sol{$\widehat{mdl} = 70.95 + 19.93 \cdot spr$}


8.  Interpret the intercept term.

\sol{With a `spr\_raw` of 0, we can expect an `mdl\_raw` of 70.95lbs. This does not make sense because we are extrapolating outside of our data.}

9.  Interpret the slope term.

\sol{On average, every one unit (meter) increase in Standing Power Throw is associated with an increase of Maximum Deadlift by 19.93lbs, holding all else equal.}

10. Conclusion of your hypothesis test at a 5% significance level.

\sol{I reject my null at the 5\% significance level that there is no association between `spr\_raw` and `mdl\_raw`.}

11. Interpret the R-squared value.

\sol{About 61\% of the variation in `mdl\_raw` is explained by `spr\_raw`.}

12. Check the 4 Validity Conditions (L.I.N.E.). Are any not met?

```{r}
lrmodel %>%
  fortify(lrmodel$model) %>%
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point()+
  geom_hline(yintercept = 0) +
  labs( x = "Predicted Values", 
        y = "Residuals", 
        title = "Residuals vs. Predicted Values")

lrmodel %>%
  fortify(lrmodel$model) %>%
  mutate(row = row_number()) %>%
  ggplot(aes(x = row, 
             y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  labs(x = "Order of Occurence", 
       y = "Residuals", 
       title = "Residuals in Order of Occurence")

lrmodel %>%
  fortify(lrmodel$model) %>%
  ggplot(aes(x = .resid)) +
  geom_histogram() +
  labs(x = "Residuals", 
       title = "Histogram of Residuals")
```

\sol{While there are "bands" in this data, that is due to the limited number of `mdl\_raw` values. Overall, the plot appears to be somewhat linear but variance is not constant! There does not appear to be independence issues and the histogram of the residuals seems fairly normal/bell-shaped.}

13. Can we determine causation? Why or why not.

\sol{No, because this was an observational study and there was no random assignment.}


## Does adding the variable `sex` change the association between the Standing Power Throw (`spr_raw`) and Leg Tuck (`ltk_raw`) raw scores?

Now, we add `sex` as another variable to the model but also include it as an interaction with `spr_raw`.

    Our updated model looks like this:

$\widehat{mdl} = \beta_0 + \beta_1 \cdot spr + \beta_2 \cdot sexmale + \beta_3 (spr \cdot sexmale)$

14.  Plot the data **(including the interaction term)**, including the regression line.

```{r}
df %>%
  ggplot(aes(x = spr_raw, y = mdl_raw, color = sex)) +
  geom_point() +
  geom_smooth(method = "lm")
```

15.  Does there appear to be a different relationship between `mdl_raw` and `spr_raw` based on `sex`?

\sol{Maybe. The lines don't have a very different slope.}

16.  Conduct a linear regression with the updated model.

```{r}
lrmodel <- df %>%
  lm(mdl_raw ~ spr_raw * sex, data = .)
summary(lrmodel)
```

17.  Interpret the coefficient on the interaction term.

\sol{The coefficient indicates that, for Males, a one-unit increase in `spr\_raw` results in an 8.66+5.797 increase in `mdl\_raw` , on average, holding all else constant.}

18.  Is this significant at the 5% level?

\sol{No, because our p-value (.1911) exceeds our significance level.}

19.  Interpret the intercept term.

\sol{With a zero `spr\_raw` , Females will exhibit a `mdl\_raw` of 119lbs.}

20.  Interpret the base slope term for `spr_raw`.

\sol{For Females, a one-unit increase in `spr\_raw` results in an 8.67 increase in `mdl\_raw`, on average, holding all else equal.}

21.  Using this model (even with no significance), calculate the following:

-   The `mdl_raw` for a male cadet with an `spr_raw` of 6m:

```{r}
(118.529 + 10.84) + 6*(8.662 + 5.797)
```

-   The `mdl_raw` for a female cadet with an `spr_raw` of 6m:

```{r}
(118.529) + 6*(8.662)
```

22.  Interpret the R-squared value.

\sol{About 66\% of the variation in `mdl\_raw` is explained by `spr\_raw` and sex and the interaction between the two.}

23. Check the 4 Validity Conditions (L.I.N.E.). Are any not met?

```{r}
lrmodel %>%
  fortify(lrmodel$model) %>%
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point()+
  geom_hline(yintercept = 0) +
  labs( x = "Predicted Values", 
        y = "Residuals", 
        title = "Residuals vs. Predicted Values")

lrmodel %>%
  fortify(lrmodel$model) %>%
  mutate(row = row_number()) %>%
  ggplot(aes(x = row, 
             y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  labs(x = "Order of Occurence", 
       y = "Residuals", 
       title = "Residuals in Order of Occurence")

lrmodel %>%
  fortify(lrmodel$model) %>%
  ggplot(aes(x = .resid)) +
  geom_histogram() +
  labs(x = "Residuals", 
       title = "Histogram of Residuals")
```
\sol{The plots look very similar to before. However, there are two-groups of residuals now...}
